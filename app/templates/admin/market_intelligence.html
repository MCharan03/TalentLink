{% extends "base.html" %}

{% block title %}Market Intelligence | SRA Admin{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="d-flex justify-content-between align-items-center mb-5 animate-up">
        <div>
            <h1 class="display-5 fw-bold text-main">Market Intelligence</h1>
            <p class="text-muted">AI-driven analysis of Supply (Users) vs. Demand (Jobs)</p>
        </div>
        <div>
            <span class="badge bg-primary fs-6">Live Analysis</span>
        </div>
    </div>

    <!-- Health Score -->
    <div class="row mb-5 animate-up delay-100">
        <div class="col-md-12">
            <div class="card border-glass p-4 position-relative overflow-hidden">
                <div class="position-absolute top-0 end-0 p-3 opacity-25">
                    <i data-feather="activity" style="width: 100px; height: 100px;"></i>
                </div>
                <div class="d-flex align-items-center">
                    <div class="me-4">
                        <div class="display-3 fw-bold {{ 'text-success' if analysis.market_health_score > 70 else 'text-warning' }}">
                            {{ analysis.market_health_score }}
                        </div>
                        <div class="text-muted text-uppercase tracking-wider">Platform Health Score</div>
                    </div>
                    <div class="border-start border-glass ps-4">
                        <p class="mb-0 text-main fst-italic">"{{ analysis.strategic_advice }}"</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Gap Analysis Grid -->
    <div class="row g-4 mb-5 animate-up delay-200">
        <!-- Undersupplied (High Opportunity) -->
        <div class="col-md-4">
            <div class="card border-glass h-100 border-top-0 border-end-0 border-bottom-0 border-3 border-danger">
                <div class="card-header bg-transparent fw-bold text-danger">
                    <i data-feather="trending-up" class="me-2"></i>High Demand / Low Supply
                </div>
                <div class="card-body">
                    <p class="small text-muted mb-3">Users need these skills to match current job postings.</p>
                    <div class="d-flex flex-wrap gap-2">
                        {% for skill in analysis.undersupplied_skills %}
                        <span class="badge bg-danger bg-opacity-10 text-danger border border-danger border-opacity-25 p-2">{{ skill }}</span>
                        {% endfor %}
                    </div>
                </div>
                <div class="card-footer bg-transparent border-0">
                    <button class="btn btn-sm btn-outline-danger w-100">Create "Quest" for these</button>
                </div>
            </div>
        </div>

        <!-- Oversupplied (Saturation) -->
        <div class="col-md-4">
            <div class="card border-glass h-100 border-top-0 border-end-0 border-bottom-0 border-3 border-warning">
                <div class="card-header bg-transparent fw-bold text-warning">
                    <i data-feather="users" class="me-2"></i>Saturated Skills
                </div>
                <div class="card-body">
                    <p class="small text-muted mb-3">Many users have these, but demand is stabilizing.</p>
                    <div class="d-flex flex-wrap gap-2">
                        {% for skill in analysis.oversupplied_skills %}
                        <span class="badge bg-warning bg-opacity-10 text-warning border border-warning border-opacity-25 p-2">{{ skill }}</span>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Emerging Trends -->
        <div class="col-md-4">
            <div class="card border-glass h-100 border-top-0 border-end-0 border-bottom-0 border-3 border-success">
                <div class="card-header bg-transparent fw-bold text-success">
                    <i data-feather="zap" class="me-2"></i>Emerging Trends
                </div>
                <div class="card-body">
                    <p class="small text-muted mb-3">Keywords appearing frequently in new job descriptions.</p>
                    <ul class="list-group list-group-flush bg-transparent">
                        {% for trend in analysis.emerging_trends %}
                        <li class="list-group-item bg-transparent text-main border-glass d-flex justify-content-between align-items-center px-0">
                            {{ trend }}
                            <i data-feather="arrow-up-right" class="text-success" style="width: 14px;"></i>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
